---
title: "BayesIngenuo"
author: "Cristopher Barrios, Carlos Daniel Estrada"
date: "2023-03-17"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
librerias
```{r  warning=FALSE, unload=TRUE}
library(rpart)
library(rpart.plot)
library(dplyr) 
library(fpc) 
library(cluster) 
library("ggpubr") 
library(mclust)
library(caret)
library(tree)
library(randomForest)
library(plyr)
library("stats")
library("datasets")
library("prediction")
library(tidyverse)
library(e1071)
```

### 1. Use los mismos conjuntos de entrenamiento y prueba que utilizó en las dos hojas anteriores.
```{r}
datos = read.csv("./train.csv")
test<- read.csv("./test.csv", stringsAsFactors = FALSE)
```

```{r}
set_entrenamiento <- sample_frac(datos, .7)
set_prueba <-setdiff(datos, set_entrenamiento)


drop <- c("LotFrontage", "Alley", "MasVnrType", "MasVnrArea", "BsmtQual", "BsmtCond", "BsmtExposure", "BsmtFinType1", "BsmtFinType2", "Electrical", "FireplaceQu", "GarageType", "GarageYrBlt", "GarageFinish", "GarageQual", "GarageCond", "PoolQC", "Fence", "MiscFeature")
set_entrenamiento <- set_entrenamiento[, !(names(set_entrenamiento) %in% drop)]
set_prueba <- set_prueba[, !(names(set_prueba) %in% drop)]
```
### 2. Elabore un modelo de regresión usando bayes ingenuo (naive bayes), el conjunto de entrenamiento y la variable respuesta SalesPrice. Prediga con el modelo y explique los resultados a los que llega. Asegúrese que los conjuntos de entrenamiento y prueba sean los mismos de las hojas anteriores para que los modelos sean comparables.
```{r }
#percentiles
percentil <- quantile(datos$SalePrice)


estado<-c('Estado')
datos$Estado<-estado
datos <- within(datos, Estado[SalePrice<=129975] <- 'Economica')
datos$Estado[(datos$SalePrice>129975 &datos$SalePrice<=163000)] <- 'Intermedia'
datos$Estado[datos$SalePrice>163000] <- 'Cara'


#Bayes 
porcentaje<-0.7

set.seed(1234)
corte <- sample(nrow(datos),nrow(datos)*porcentaje)

#Entrenamiento
train<-datos[corte,]
#Prueba
test<-datos[-corte,]

```


### 3. Haga un modelo de clasificación, use la variable categórica que hizo con el precio de las casas (barata, media y cara) como variable respuesta.
```{r  warning=FALSE, unload=TRUE}
#modelo
modelo<-naiveBayes(train$Estado~., data=train)

#Casting 
test$GrLivArea<-as.numeric(test$GrLivArea)
test$YearBuilt<-as.numeric(test$YearBuilt)
test$BsmtUnfSF<-as.numeric(test$BsmtUnfSF)
test$TotalBsmtSF<-as.numeric(test$TotalBsmtSF)
test$GarageArea<-as.numeric(test$GarageArea)
test$YearRemodAdd<-as.numeric(test$YearRemodAdd)
test$SalePrice<-as.numeric(test$SalePrice)
test$LotArea<-as.numeric(test$LotArea)

#prediccion
predBayes<-predict(modelo, newdata = test[,c("GrLivArea","YearBuilt","BsmtUnfSF","TotalBsmtSF","GarageArea","YearRemodAdd", "SalePrice","LotArea")])

#Convertimos
predBayes<-as.factor(predBayes)
#confusion
cm<-caret::confusionMatrix(as.factor(predBayes),as.factor(test$Estado))
cm

```


### 4. Utilice los modelos con el conjunto de prueba y determine la eficiencia del algoritmo para predecir y clasificar.
```{r}
table(predBayes)
table(test$Estado)
```

### 5. Analice los resultados del modelo de regresión. ¿Qué tan bien le fue prediciendo?

### 6. Compare los resultados con el modelo de regresión lineal y el árbol de regresión que hizo en las hojas pasadas. ¿Cuál funcionó mejor?

### 7. Haga un análisis de la eficiencia del modelo de clasificación usando una matriz de confusión. Tenga en cuenta la efectividad, donde el algoritmo se equivocó más, donde se equivocó menos y la importancia que tienen los errores.

### 8. Analice el modelo. ¿Cree que pueda estar sobre ajustado?

### 9. Haga un modelo usando validación cruzada, compare los resultados de este con los del modelo anterior. ¿Cuál funcionó mejor?

### 10. Compare la eficiencia del algoritmo con el resultado obtenido con el árbol de decisión (el de clasificación) y el modelo de random forest que hizo en la hoja pasada. ¿Cuál es mejor para predecir? ¿Cuál se demoró más en procesar?